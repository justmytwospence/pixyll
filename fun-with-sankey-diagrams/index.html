<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <title>Fun with Sankey diagrams &#8211; Spencer Boucher</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="Let&#39;s have some fun with some unconventional data munging and an unconventional data visualization technique, using our three favorite tools: Python, R, and D3
">
    <meta name="author" content="Spencer Boucher">
    <meta name="keywords" content="">
    <link rel="canonical" href="http://spencerboucher.com/fun-with-sankey-diagrams/">
    <link rel="alternate" type="application/rss+xml" title="RSS Feed for Spencer Boucher" href="/feed.xml" />

    <!-- Custom CSS -->
    <link rel="stylesheet" href="/css/pixyll.css?201601301922" type="text/css">

    <!-- Fonts -->
    <link href='//fonts.googleapis.com/css?family=Merriweather:900,900italic,300,300italic' rel='stylesheet' type='text/css'>
    <link href='//fonts.googleapis.com/css?family=Lato:900,300' rel='stylesheet' type='text/css'>
    

    <!-- MathJax -->
    
    <script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
    </script>
    

    <!-- Verifications -->
    

    <!-- Open Graph -->
    <!-- From: https://github.com/mmistakes/hpstr-jekyll-theme/blob/master/_includes/head.html -->
    <meta property="og:locale" content="en_US">
    <meta property="og:type" content="article">
    <meta property="og:title" content="Fun with Sankey diagrams">
    <meta property="og:description" content="">
    <meta property="og:url" content="http://spencerboucher.com/fun-with-sankey-diagrams/">
    <meta property="og:site_name" content="Spencer Boucher">

    <!-- Twitter Card -->
    <meta name="twitter:card" content="summary" />
    
        <meta name="twitter:site" content="@justmytwospence" />
    
    <meta name="twitter:title" content="Fun with Sankey diagrams" />
    <meta name="twitter:description" content="Let's have some fun with some unconventional data munging and an unconventional data visualization technique, using our three favorite tools: Python, R, and D3
" />
    <meta name="twitter:url" content="http://spencerboucher.com/fun-with-sankey-diagrams/" />

    <!-- Icons -->
    <link rel="apple-touch-icon" sizes="57x57" href="/apple-touch-icon-57x57.png">
    <link rel="apple-touch-icon" sizes="114x114" href="/apple-touch-icon-114x114.png">
    <link rel="apple-touch-icon" sizes="72x72" href="/apple-touch-icon-72x72.png">
    <link rel="apple-touch-icon" sizes="144x144" href="/apple-touch-icon-144x144.png">
    <link rel="apple-touch-icon" sizes="60x60" href="/apple-touch-icon-60x60.png">
    <link rel="apple-touch-icon" sizes="120x120" href="/apple-touch-icon-120x120.png">
    <link rel="apple-touch-icon" sizes="76x76" href="/apple-touch-icon-76x76.png">
    <link rel="apple-touch-icon" sizes="152x152" href="/apple-touch-icon-152x152.png">
    <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon-180x180.png">
    <link rel="icon" type="image/png" href="/favicon-192x192.png" sizes="192x192">
    <link rel="icon" type="image/png" href="/favicon-160x160.png" sizes="160x160">
    <link rel="icon" type="image/png" href="/favicon-96x96.png" sizes="96x96">
    <link rel="icon" type="image/png" href="/favicon-16x16.png" sizes="16x16">
    <link rel="icon" type="image/png" href="/favicon-32x32.png" sizes="32x32">

    
    <script type="text/javascript">
       (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
       (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
       m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
       })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
       ga('create', 'UA-45101202-1', 'auto');
       ga('send', 'pageview');
    </script>
    
</head>

<body class="site animated fade-in-down">

	

  <div class="site-wrap">
    <header class="site-header px2 px-responsive">
  <div class="mt2 wrap">
    <div class="measure">
      <a href="http://spencerboucher.com" class="site-title">Spencer Boucher</a>
      <nav class="site-nav">
        
    

    
        <a href="/about/">About</a>
    

    

    

    

    

    

    

    

    


    

    

    
        <a href="/contact/">Contact</a>
    

    

    

    

    

    

    

    


      </nav>
      <div class="clearfix"></div>
      
    </div>
  </div>
</header>


    <div class="post p2 p-responsive wrap" role="main">
      <div class="measure">
        


<div class="post-header mb2">
  <h1>Fun with Sankey diagrams</h1>
  <span class="post-meta">March 13, 2014</span><br>
  
  <span class="post-meta small">
  
    6 minute read
  
  </span>
</div>

<article class="post-content">
  <p>I&rsquo;m currently working on the final project for my data visualization course. The
dataset that I&rsquo;ve chosen to work with can be <a href="http://snap.stanford.edu/data/web-Reddit.html">downloaded here</a> &ndash; it&rsquo;s a
compendium Reddit resubmissions over a period of several years (ie, images that
were submitted to more than one and/or to multiple subreddits). I waffled for a
long time trying to decide what the best way to visualize the <em>flow</em> of images
through various subreddits would be, but just in the nick of time, I stumbled
across Christopher Gandrud&rsquo;s new <a href="http://christophergandrud.github.io/d3Network/">d3Network package for R</a>, and that was
enough cause for me to settle on a Sankey diagram. If you&rsquo;ve never heard of
Reddit, the illustrious CPG Grey will enlighten you.</p>
<div class="highlight"><pre><code class="language-python" data-lang="python"><span class="kn">from</span> <span class="nn">IPython.display</span> <span class="kn">import</span> <span class="n">YouTubeVideo</span>
<span class="n">YouTubeVideo</span><span class="p">(</span><span class="s">'tlI022aUWQQ'</span><span class="p">)</span>
</code></pre></div>
<iframe width="400" height=300" src="https://www.youtube.com/embed/tlI022aUWQQ"
frameborder="0" allowfullscreen ></iframe>

<p>The task of massaging columnar data consisting of an image ID, subreddit name,
and timestamp for each submission into a more networky format suitable for this
type of visualization was interesting enough that I thought it might be a good
post. If nothing else, Christopher&rsquo;s awesome package deserves some love.</p>

<p>Python is my go-to language for data munging of this calibre, so we will use a
Pandas -&gt; NetworkX -&gt; R -&gt; D3 worflow. Without further ado, lets load the Python
modules we will need and take a look at the data.</p>
<div class="highlight"><pre><code class="language-python" data-lang="python"><span class="c"># Load modules and data</span>

<span class="kn">import</span> <span class="nn">pandas</span> <span class="kn">as</span> <span class="nn">pd</span>                        <span class="c"># For reading/munging the data</span>
<span class="kn">import</span> <span class="nn">networkx</span> <span class="kn">as</span> <span class="nn">nx</span>                      <span class="c"># For creating a graph structure</span>
<span class="kn">from</span> <span class="nn">networkx.readwrite</span> <span class="kn">import</span> <span class="n">json_graph</span>  <span class="c"># For exporting a graph structure</span>
<span class="kn">from</span> <span class="nn">itertools</span> <span class="kn">import</span> <span class="n">islice</span>               <span class="c"># For some more interesting munging</span>

<span class="o">%</span><span class="n">load_ext</span> <span class="n">rmagic</span>
<span class="kn">from</span> <span class="nn">IPython.display</span> <span class="kn">import</span> <span class="n">HTML</span>           <span class="c"># To display results when we're done</span>

<span class="err">!</span><span class="n">csvclean</span> <span class="n">redditSubmissions</span><span class="o">.</span><span class="n">csv</span>
<span class="n">d</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s">'redditSubmissions_out.csv'</span><span class="p">)</span>
</code></pre></div>
<p>Note that I first called <code>csvclean</code>, from the
<a href="http://csvkit.readthedocs.org/en/latest/index.html">csvkit suite of command line utilities</a>. The bang (!) symbol calls the
command line from IPython. <code>csvclean</code> fixes a couple of formatting errors in the
original dataset that interfere with R/Panda&rsquo;s parsing functions (something to
do with quotes or commas in the &ldquo;title&rdquo; field, I believe). The repaired CSV is
saved with a <code>_out</code> prepended to the filename. Nothing fancy is required for the
<code>read_csv</code> call in our case.</p>

<p>Now for the hard/interesting part. How do we map the flow of each image
submission through the various subreddits?</p>

<ul>
<li>First we sort by image and (crucially) timetamp on line 4.</li>
<li>On line 5, I simply extract the 3 columns that we care about.</li>
<li>Now we drop resubmissions of each image to the <em>same</em> subreddit with
drop_duplicates on line 6, which only keeps each image&rsquo;s <em>first</em> submission
to a particular subreddit (why we sorted first).</li>
<li>The last thing we need Pandas for is to group by image ID (line 7).</li>
</ul>

<p>On line 7, we pull the list of subreddits (now unique and nicely ordered) for
each image. The nested list comprehension is necessary only because calling
<code>.subreddit</code> on the groupby object <code>g</code> returns a tuple by default, and we&rsquo;d
rather have a list of lists.</p>
<div class="highlight"><pre><code class="language-python" data-lang="python"><span class="c"># Identify the order in which each image is submitted to various subreddits,</span>
<span class="c"># removing repeats within a subreddit</span>

<span class="n">g</span> <span class="o">=</span> <span class="n">d</span><span class="o">.</span><span class="n">sort</span><span class="p">([</span><span class="s">'#image_id'</span><span class="p">,</span> <span class="s">'unixtime'</span><span class="p">])</span>\
     <span class="o">.</span><span class="n">ix</span><span class="p">[:,[</span><span class="s">'#image_id'</span><span class="p">,</span> <span class="s">'unixtime'</span><span class="p">,</span> <span class="s">'subreddit'</span><span class="p">]]</span>\
     <span class="o">.</span><span class="n">drop_duplicates</span><span class="p">(</span><span class="n">cols</span> <span class="o">=</span> <span class="p">[</span><span class="s">'#image_id'</span><span class="p">,</span> <span class="s">'subreddit'</span><span class="p">])</span>\
     <span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s">'#image_id'</span><span class="p">)</span>
<span class="n">flow</span> <span class="o">=</span> <span class="p">[[</span><span class="n">el</span> <span class="k">for</span> <span class="n">el</span> <span class="ow">in</span> <span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">g</span><span class="o">.</span><span class="n">subreddit</span><span class="p">)]</span>
</code></pre></div>
<p>Now we need a function <code>window</code> that rolls along each of the lists in <code>flow</code> and
connects every subsequent pair of subreddits that a particular image was
submitted to. We&rsquo;ll do this with the help of the wonderful <code>itertools</code> module,
creating two dimensional tuples that encode the &ldquo;from&rdquo; subreddit and the &ldquo;to&rdquo;
subreddit, respectively. In lines 14 and 15, we apply the function and flatten
the result to a single list.</p>

<p>In order to truly capture the &ldquo;flow,&rdquo; however, we need to distinguish between
the &ldquo;gifs&rdquo; subreddit node where images are popping up for the first time and the
&ldquo;gifs&rdquo; subreddit node when the image has already appeared in another subreddit
(say, &ldquo;pics&rdquo;). The <code>enumerate</code> in line 14 does this by tacking on the ordinality
to the name of the node, admittedly very hacky, but we have a lot of tuples
floating around already.</p>
<div class="highlight"><pre><code class="language-python" data-lang="python"><span class="c"># Roll along the list of subreddits each image has been submitted to,</span>
<span class="c"># creating an edge tuple for each subsequent pair</span>
<span class="k">def</span> <span class="nf">window</span><span class="p">(</span><span class="n">seq</span><span class="p">,</span> <span class="n">n</span><span class="o">=</span><span class="mi">2</span><span class="p">):</span>
    <span class="s">'''Returns a sliding window (of width n) over data from the iterable
       s -&gt; (s0,s1,...s[n-1]), (s1,s2,...,sn), ...'''</span>
    <span class="n">it</span> <span class="o">=</span> <span class="nb">iter</span><span class="p">(</span><span class="n">seq</span><span class="p">)</span>
    <span class="n">result</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">islice</span><span class="p">(</span><span class="n">it</span><span class="p">,</span> <span class="n">n</span><span class="p">))</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">result</span><span class="p">)</span> <span class="o">==</span> <span class="n">n</span><span class="p">:</span>
        <span class="k">yield</span> <span class="n">result</span>
    <span class="k">for</span> <span class="n">elem</span> <span class="ow">in</span> <span class="n">it</span><span class="p">:</span>
        <span class="n">result</span> <span class="o">=</span> <span class="n">result</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span> <span class="o">+</span> <span class="p">(</span><span class="n">elem</span><span class="p">,)</span>
        <span class="k">yield</span> <span class="n">result</span>

<span class="n">sankey</span> <span class="o">=</span> <span class="p">[</span><span class="nb">list</span><span class="p">(</span><span class="n">window</span><span class="p">([</span><span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="o">+</span> <span class="n">x</span> <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">sub</span><span class="p">)]))</span> <span class="k">for</span> <span class="n">sub</span> <span class="ow">in</span> <span class="n">flow</span><span class="p">]</span>
<span class="n">sankey</span> <span class="o">=</span> <span class="p">[</span><span class="n">item</span> <span class="k">for</span> <span class="n">sublist</span> <span class="ow">in</span> <span class="n">sankey</span> <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">sublist</span><span class="p">]</span> <span class="c"># flatten</span>
</code></pre></div>
<p>At last we have a list of edges that on some level describes the flow that we
are trying to get at. Now we can just iterate through them and use <code>NetworkX</code> to
create the graph and weight the edges appropriately. In lines 10&ndash;13, I prune
back the tiny edges that clutter up the diagram, and then the nodes that are no
longer associated with any edges. Last but not least, we export the structure to
a JSON in line 16.</p>
<div class="highlight"><pre><code class="language-python" data-lang="python"><span class="c"># Create network structure</span>
<span class="n">S</span> <span class="o">=</span> <span class="n">nx</span><span class="o">.</span><span class="n">DiGraph</span><span class="p">()</span>
<span class="k">for</span> <span class="n">edge</span> <span class="ow">in</span> <span class="n">sankey</span><span class="p">:</span>
    <span class="k">if</span> <span class="n">S</span><span class="o">.</span><span class="n">has_edge</span><span class="p">(</span><span class="o">*</span><span class="n">edge</span><span class="p">):</span>
        <span class="n">S</span><span class="p">[</span><span class="n">edge</span><span class="p">[</span><span class="mi">0</span><span class="p">]][</span><span class="n">edge</span><span class="p">[</span><span class="mi">1</span><span class="p">]][</span><span class="s">'weight'</span><span class="p">]</span> <span class="o">+=</span><span class="mi">1</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">S</span><span class="o">.</span><span class="n">add_edge</span><span class="p">(</span><span class="o">*</span><span class="n">edge</span><span class="p">,</span> <span class="n">weight</span> <span class="o">=</span> <span class="mi">1</span><span class="p">)</span>

<span class="c"># Trim edges</span>
<span class="n">S</span><span class="o">.</span><span class="n">remove_edges_from</span><span class="p">([</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">S</span><span class="o">.</span><span class="n">edges</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span> <span class="k">if</span> <span class="n">x</span><span class="p">[</span><span class="mi">2</span><span class="p">][</span><span class="s">'weight'</span><span class="p">]</span> <span class="o">&lt;</span> <span class="mi">50</span><span class="p">])</span>
<span class="n">flagged</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span><span class="p">,</span> <span class="n">el</span> <span class="ow">in</span> <span class="n">S</span><span class="o">.</span><span class="n">out_degree</span><span class="p">()</span><span class="o">.</span><span class="n">items</span><span class="p">()</span> <span class="k">if</span> <span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">!=</span> <span class="s">'3'</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">el</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)]</span>
<span class="n">S</span><span class="o">.</span><span class="n">remove_edges_from</span><span class="p">([</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">S</span><span class="o">.</span><span class="n">edges</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span> <span class="k">if</span> <span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="ow">in</span> <span class="n">flagged</span><span class="p">])</span>
<span class="n">S</span><span class="o">.</span><span class="n">remove_nodes_from</span><span class="p">([</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span><span class="p">,</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">S</span><span class="o">.</span><span class="n">degree</span><span class="p">()</span><span class="o">.</span><span class="n">items</span><span class="p">()</span> <span class="k">if</span> <span class="n">n</span> <span class="o">==</span> <span class="mi">0</span><span class="p">])</span>

<span class="c"># Export</span>
<span class="n">json_graph</span><span class="o">.</span><span class="n">dump</span><span class="p">(</span><span class="n">S</span><span class="p">,</span> <span class="nb">open</span><span class="p">(</span><span class="s">'sankey.json'</span><span class="p">,</span> <span class="s">'w'</span><span class="p">))</span>
</code></pre></div>
<p>Time for R!</p>

<p>We will need to make sure that <code>d3Network</code> is installed to the the instance of R
that is used by IPython&rsquo;s <code>Rmagic</code> via <code>Rpy2</code>. It was different for me (I
think?) so if you are running something like this for the first time, include
the lines that are commented out.</p>

<p>The <code>%%R</code> denotes block-level R magicks in IPython (<code>%R</code> will give you
line-level magicks)</p>
<div class="highlight"><pre><code class="language-R" data-lang="R"><span class="o">%%</span><span class="n">R</span>
<span class="n">install.packages</span><span class="p">(</span><span class="s1">'devtools'</span><span class="p">)</span>
<span class="n">library</span><span class="p">(</span><span class="n">devtools</span><span class="p">)</span>
<span class="n">devtools</span><span class="o">::</span><span class="n">install_github</span><span class="p">(</span><span class="s2">"christophergandrud/d3Network"</span><span class="p">)</span>
<span class="n">library</span><span class="p">(</span><span class="n">d3Network</span><span class="p">)</span>
</code></pre></div>
<p>This is finally the point at which Christopher Gandrud&rsquo;s package simplifies
everything for us. We simply read in the nodes and linkes (edges) from the JSON
file (they get converted to two dataframes). Note that we have to strip the
janky ordinality numbers that we tacked onto the node names (line 3). Now that
different nodes have the same names, the package will even make sure that each
subreddit node has the same color every time it appears!</p>

<p>The call to <code>d3Sankey</code> points to the the nodes dataframe, the links dataframe,
the name of the sources/targets in the links dataframe, the name of the column
that holds the link weights, and then some display configuration stuff.</p>
<div class="highlight"><pre><code class="language-R" data-lang="R"><span class="o">%%</span><span class="n">R</span>
<span class="n">nodes</span> <span class="o">&lt;-</span> <span class="n">JSONtoDF</span><span class="p">(</span><span class="n">file</span> <span class="o">=</span> <span class="n">paste0</span><span class="p">(</span><span class="s1">'sankey.json'</span><span class="p">),</span> <span class="n">array</span> <span class="o">=</span> <span class="s1">'nodes'</span><span class="p">)</span>
<span class="n">nodes</span><span class="o">$</span><span class="n">id</span> <span class="o">&lt;-</span> <span class="n">substring</span><span class="p">(</span><span class="n">nodes</span><span class="o">$</span><span class="n">id</span><span class="p">,</span> <span class="m">2</span><span class="p">)</span>
<span class="n">links</span> <span class="o">&lt;-</span> <span class="n">JSONtoDF</span><span class="p">(</span><span class="n">file</span> <span class="o">=</span> <span class="n">paste0</span><span class="p">(</span><span class="s1">'sankey.json'</span><span class="p">),</span> <span class="n">array</span> <span class="o">=</span> <span class="s1">'links'</span><span class="p">)</span>
<span class="n">d3Sankey</span><span class="p">(</span><span class="n">Nodes</span> <span class="o">=</span> <span class="n">nodes</span><span class="p">,</span> <span class="n">Links</span> <span class="o">=</span> <span class="n">links</span><span class="p">,</span> <span class="n">Source</span> <span class="o">=</span> <span class="s1">'source'</span><span class="p">,</span>
         <span class="n">Target</span> <span class="o">=</span> <span class="s1">'target'</span><span class="p">,</span> <span class="n">Value</span> <span class="o">=</span> <span class="s1">'weight'</span><span class="p">,</span> <span class="n">NodeID</span> <span class="o">=</span> <span class="s1">'id'</span><span class="p">,</span>
         <span class="n">width</span> <span class="o">=</span> <span class="m">600</span><span class="p">,</span> <span class="n">height</span> <span class="o">=</span> <span class="m">500</span><span class="p">,</span> <span class="n">fontsize</span> <span class="o">=</span> <span class="m">12</span><span class="p">,</span>
         <span class="n">standAlone</span> <span class="o">=</span> <span class="n">TRUE</span><span class="p">,</span> <span class="n">iframe</span> <span class="o">=</span> <span class="n">TRUE</span><span class="p">,</span> <span class="n">file</span> <span class="o">=</span> <span class="s1">'sankey.html'</span><span class="p">)</span>
</code></pre></div>
<p>We can render the resulting iframe directly in our IPython notebook! Hover over
edges for some nice brushing or click and drag the nodes to untangle a
relationship you&rsquo;re interested in.</p>
<div class="highlight"><pre><code class="language-python" data-lang="python"><span class="n">HTML</span><span class="p">(</span><span class="s">'&lt;iframe src="./sankey.html" height=540 width=700 frameBorder="0"&gt;&lt;/iframe&gt;'</span><span class="p">)</span>
</code></pre></div>
<iframe src="http://spencerboucher.com/images/sankey.html" height=540 width=700 frameBorder="0"></iframe>

<p>This type of &ldquo;tiered&rdquo; Sankey diagram is a little unconventional, but so far its
the best way I can come up with to visualize the interesting phenomenon of
submission flow through Reddit. Leave a comment if this gives you any
interesting ideas, I&rsquo;d love to hear them!</p>

</article>




  <div class="py2 post-footer">
  <img src="/images/avatar.jpg" alt="Spencer Boucher" class="avatar" />
  <p>
    Spencer is a data scientist living in San Francisco, California.
  </p>
  <p>
    The source code for this post can be found <a href="https://github.com/justmytwospence/pixyll/tree/master/_posts/2014-05-13-fun-with-sankey-diagrams.md">here</a>.
  </p>
</div>




  <div id="disqus_thread"></div>
  <script type="text/javascript">
    var disqus_shortname  = 'justmytwospence';
    var disqus_identifier = '/fun-with-sankey-diagrams';
    var disqus_title      = 'Fun with Sankey diagrams';

    (function() {
      var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
      dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
  </script>
  <noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>






      </div>
    </div>
  </div>

  <footer class="center">
  <div class="measure">
    <small>
      Built with jekyll, github-pages, and <a href="https://github.com/johnotander/pixyll">Pixyll</a>.
    </small>
  </div>
</footer>

</body>
</html>
