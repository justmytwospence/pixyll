<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <title>Live mapping &#8211; Spencer Boucher</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="Let&#39;s put on our quantified-self hats and find out where we spend our time!">
    <meta name="author" content="Spencer Boucher">
    <meta name="keywords" content="">
    <link rel="canonical" href="http://spencerboucher.com/live-mapping/">
    <link rel="alternate" type="application/rss+xml" title="RSS Feed for Spencer Boucher" href="/feed.xml" />

    <!-- Custom CSS -->
    <link rel="stylesheet" href="/css/pixyll.css?201601181942" type="text/css">

    <!-- Fonts -->
    <link href='//fonts.googleapis.com/css?family=Merriweather:900,900italic,300,300italic' rel='stylesheet' type='text/css'>
    <link href='//fonts.googleapis.com/css?family=Lato:900,300' rel='stylesheet' type='text/css'>
    

    <!-- MathJax -->
    
    <script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
    </script>
    

    <!-- Verifications -->
    

    <!-- Open Graph -->
    <!-- From: https://github.com/mmistakes/hpstr-jekyll-theme/blob/master/_includes/head.html -->
    <meta property="og:locale" content="en_US">
    <meta property="og:type" content="article">
    <meta property="og:title" content="Live mapping">
    <meta property="og:description" content="">
    <meta property="og:url" content="http://spencerboucher.com/live-mapping/">
    <meta property="og:site_name" content="Spencer Boucher">

    <!-- Twitter Card -->
    <meta name="twitter:card" content="summary" />
    
        <meta name="twitter:site" content="@justmytwospence" />
    
    <meta name="twitter:title" content="Live mapping" />
    <meta name="twitter:description" content="Let's put on our quantified-self hats and find out where we spend our time!" />
    <meta name="twitter:url" content="http://spencerboucher.com/live-mapping/" />

    <!-- Icons -->
    <link rel="apple-touch-icon" sizes="57x57" href="/apple-touch-icon-57x57.png">
    <link rel="apple-touch-icon" sizes="114x114" href="/apple-touch-icon-114x114.png">
    <link rel="apple-touch-icon" sizes="72x72" href="/apple-touch-icon-72x72.png">
    <link rel="apple-touch-icon" sizes="144x144" href="/apple-touch-icon-144x144.png">
    <link rel="apple-touch-icon" sizes="60x60" href="/apple-touch-icon-60x60.png">
    <link rel="apple-touch-icon" sizes="120x120" href="/apple-touch-icon-120x120.png">
    <link rel="apple-touch-icon" sizes="76x76" href="/apple-touch-icon-76x76.png">
    <link rel="apple-touch-icon" sizes="152x152" href="/apple-touch-icon-152x152.png">
    <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon-180x180.png">
    <link rel="icon" type="image/png" href="/favicon-192x192.png" sizes="192x192">
    <link rel="icon" type="image/png" href="/favicon-160x160.png" sizes="160x160">
    <link rel="icon" type="image/png" href="/favicon-96x96.png" sizes="96x96">
    <link rel="icon" type="image/png" href="/favicon-16x16.png" sizes="16x16">
    <link rel="icon" type="image/png" href="/favicon-32x32.png" sizes="32x32">

    
    <script type="text/javascript">
       (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
       (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
       m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
       })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
       ga('create', 'UA-45101202-1', 'auto');
       ga('send', 'pageview');
    </script>
    
</head>

<body class="site animated fade-in-down">

	

  <div class="site-wrap">
    <header class="site-header px2 px-responsive">
  <div class="mt2 wrap">
    <div class="measure">
      <a href="http://spencerboucher.com" class="site-title">Spencer Boucher</a>
      <nav class="site-nav">
        
    

    
        <a href="/about/">About</a>
    

    

    

    

    

    

    

    

    

    


    

    

    
        <a href="/contact/">Contact</a>
    

    

    

    

    

    

    

    

    


      </nav>
      <div class="clearfix"></div>
      
    </div>
  </div>
</header>


    <div class="post p2 p-responsive wrap" role="main">
      <div class="measure">
        


<div class="post-header mb2">
  <h1>Live mapping</h1>
  <span class="post-meta">January 8, 2014</span><br>
  
  <span class="post-meta small">
  
    8 minute read
  
  </span>
</div>

<article class="post-content">
  <p>I&rsquo;ve been wanting to do some more mapping stuff since my first
encounter with Leaflet a month or two ago while I was working on a
project for <a href="https://auto-grid.com">AutoGrid</a>. I had my eye on
CartoDB&rsquo;s time series library,
<a href="https://github.com/cartodb/torque">Torque</a>, because I had really
wanted to do some time-series visualization, but time constraints and
privacy issues with uploading data to CartoDB&rsquo;s servers prevented me
from really exploring. Since I had a few days of free time over winter
break, I played around with it a bit and came up with this:
<a href="http://www.spencerboucher.com/map">spencerboucher.com/map</a>. How&rsquo;d I do it?</p>

<p>First I needed some geographic data, so I turned to a source of data
I&rsquo;ve been collected for almost a year - my own
location. <a href="https://openpaths.cc">OpenPaths</a> is a mobile app that
records your location at regular time intervals. I opted for every 30
minutes at first, then upped it to every 15 minutes when I discovered
that the effect on battery life wasn&rsquo;t nearly as bad as I expected it
to be. OpenPaths is a project of
<a href="https://nytlabs.com">the R&amp;D department at The New York Times</a> and
they <a href="https://openpaths.cc/FAQ">claim</a> that you are the only one with access to the collected
data. Interestingly, you can grant various <a href="https://openpaths.cc/projects">research programs</a>
access to your data at your own discretion. Your data is conveniently
downloadable as a csv, json, or kml file, so I easily pulled my
dataset of ~3,000 time points since December 2012. Unfortunately, I
made the switch from iPhone to Android around April (well, that part
is fortunate), and forgot to re-download the app, so I only really
have data from the around the first three months and last two months
of 2013.</p>

<p>Turns out, making impressive maps with CartoDB is almost
embarrassingly easy. Their GUI is pretty intuitive and running queries
on their postgreSQL database is simple. Even time series stuff built
on the Torque backend is really just point and click. I decided that
the best way to visualize this data was with an aggregated hexbin
heatmap of all my past locations, overlaid with a point-by-point
replay with a time-slider. From there, it was just a one-line API call
to host the map on my website (line 30 highlighted below), which is
significantly easier than the legwork that went into crafting a
Leaflet map &ldquo;manually.&rdquo;</p>
<div class="highlight"><pre><code class="language-html" data-lang="html"><span class="nt">&lt;html&gt;</span>

<span class="nt">&lt;head&gt;</span>

  <span class="nt">&lt;meta</span> <span class="na">name=</span><span class="s">"viewport"</span> <span class="na">content=</span><span class="s">"initial-scale=1.0, user-scalable=no"</span> <span class="nt">/&gt;</span>

  <span class="nt">&lt;title&gt;</span>Location | Spencer<span class="nt">&lt;/title&gt;</span>

  <span class="nt">&lt;link</span> <span class="na">rel=</span><span class="s">"shortcut icon"</span> <span class="na">href=</span><span class="s">"http://spencerboucher.com/map/favicon.png"</span> <span class="nt">/&gt;</span>
  <span class="nt">&lt;link</span> <span class="na">rel=</span><span class="s">"stylesheet"</span> <span class="na">href=</span><span class="s">"http://libs.cartocdn.com/cartodb.js/v3/themes/css/cartodb.css"</span> <span class="nt">/&gt;</span>
  <span class="c">&lt;!--[if lte IE 8]&gt;
    &lt;link rel="stylesheet" href="http://libs.cartocdn.com/cartodb.js/v3/themes/css/cartodb.ie.css" /&gt;
  &lt;![endif]--&gt;</span>

  <span class="nt">&lt;style </span><span class="na">type=</span><span class="s">"text/css"</span><span class="nt">&gt;</span>
      <span class="nt">html</span><span class="o">,</span> <span class="nt">body</span><span class="o">,</span> <span class="nf">#map</span> <span class="p">{</span>
          <span class="nl">margin</span><span class="p">:</span> <span class="m">0</span><span class="p">;</span>
          <span class="nl">padding</span><span class="p">:</span> <span class="m">0</span><span class="p">;</span>
          <span class="nl">width</span><span class="p">:</span> <span class="m">100%</span><span class="p">;</span>
          <span class="nl">height</span><span class="p">:</span> <span class="m">100%</span><span class="p">;</span>
          <span class="nl">background</span><span class="p">:</span> <span class="no">black</span><span class="p">;</span> <span class="p">}</span>
      <span class="nf">#cartodb-gmaps-attribution</span> <span class="p">{</span>
        <span class="nl">visibility</span><span class="p">:</span> <span class="nb">hidden</span><span class="p">;</span> <span class="p">}</span>
  <span class="nt">&lt;/style&gt;</span>

  <span class="nt">&lt;script </span><span class="na">src=</span><span class="s">"http://maps.google.com/maps/api/js?v=3.2&amp;sensor=false"</span><span class="nt">&gt;&lt;/script&gt;</span>
  <span class="nt">&lt;script </span><span class="na">src=</span><span class="s">"http://libs.cartocdn.com/cartodb.js/v3/cartodb.js"</span><span class="nt">&gt;&lt;/script&gt;</span>
  <span class="nt">&lt;script&gt;</span>
    <span class="kd">function</span> <span class="nx">init</span><span class="p">(){</span>
      <span class="nx">cartodb</span><span class="p">.</span><span class="nx">createVis</span><span class="p">(</span><span class="s1">'map'</span><span class="p">,</span> <span class="s1">'http://justmytwospence.cartodb.com/api/v2/viz/e8fd87d0-78b3-11e3-a9e9-e7941b6e2df0/viz.json'</span><span class="p">);</span> <span class="p">}</span>
  <span class="nt">&lt;/script&gt;</span>

<span class="nt">&lt;/head&gt;</span>

<span class="nt">&lt;body</span> <span class="na">onload=</span><span class="s">"init()"</span><span class="nt">&gt;</span>
  <span class="nt">&lt;div</span> <span class="na">id=</span><span class="s">'map'</span><span class="nt">&gt;&lt;/div&gt;</span>
<span class="nt">&lt;/body&gt;</span>

<span class="nt">&lt;/html&gt;</span>
</code></pre></div>
<p>This is pretty awesome, but in light of how easy it all was, I was
almost disappointed. Can we take it one step further? Let&rsquo;s put on our
<a href="http://quantifiedself.com/about/">Quantified Self</a> hats and set about to make this map
<em>live</em>. There&rsquo;s three components to making this happen, so we&rsquo;ll step
through them one at a time. First we need to access the most recent
data from OpenPaths (there&rsquo;s an API for that!), and then we need to
insert that data into CartoDB&rsquo;s database (guess what, there&rsquo;s an API
for that too). Last but not least, we need to schedule that data
transplant to occur on a regular basis. The Unix utility <code>cron</code> is the
canonical tool for this type of thing, so this seemed like a good time
to learn how to use it.</p>

<p>Python has a reputation for being a great &ldquo;glue&rdquo; language, so that&rsquo;s
what we&rsquo;ll use to build this script.</p>

<p>Programmatically accessing your data from OpenPaths is super
simple. This piece of our script is pulled more or less verbatim from
<a href="https://openpaths.cc/api">the OpenPaths API documentation</a>. Line 21 (highlighted below) is
key - this is where we specify which data you want to pull for
injection into the CartoDB database. Here we will grab the last 24
hours of data (~96 readings, if you&rsquo;re collecting every 15 minutes
like me), getting the results in a nice JSON-formatted variable named
<code>data</code>.</p>
<div class="highlight"><pre><code class="language-python" data-lang="python"><span class="kn">import</span> <span class="nn">oauth2</span><span class="o">,</span> <span class="nn">time</span><span class="o">,</span> <span class="nn">urllib</span><span class="o">,</span> <span class="nn">urllib2</span><span class="o">,</span> <span class="nn">json</span>

<span class="n">ACCESS</span> <span class="o">=</span> <span class="s">'redacted'</span>
<span class="n">SECRET</span> <span class="o">=</span> <span class="s">'redacted'</span>
<span class="n">URL</span> <span class="o">=</span> <span class="s">'https://openpaths.cc/api/1'</span>

<span class="k">def</span> <span class="nf">build_auth_header</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">method</span><span class="p">):</span>
    <span class="n">params</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s">'oauth_version'</span><span class="p">:</span> <span class="s">"1.0"</span><span class="p">,</span>
        <span class="s">'oauth_nonce'</span><span class="p">:</span> <span class="n">oauth2</span><span class="o">.</span><span class="n">generate_nonce</span><span class="p">(),</span>
        <span class="s">'oauth_timestamp'</span><span class="p">:</span> <span class="nb">int</span><span class="p">(</span><span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()),</span>
    <span class="p">}</span>
    <span class="n">consumer</span> <span class="o">=</span> <span class="n">oauth2</span><span class="o">.</span><span class="n">Consumer</span><span class="p">(</span><span class="n">key</span><span class="o">=</span><span class="n">ACCESS</span><span class="p">,</span> <span class="n">secret</span><span class="o">=</span><span class="n">SECRET</span><span class="p">)</span>
    <span class="n">params</span><span class="p">[</span><span class="s">'oauth_consumer_key'</span><span class="p">]</span> <span class="o">=</span> <span class="n">consumer</span><span class="o">.</span><span class="n">key</span>
    <span class="n">request</span> <span class="o">=</span> <span class="n">oauth2</span><span class="o">.</span><span class="n">Request</span><span class="p">(</span><span class="n">method</span><span class="o">=</span><span class="n">method</span><span class="p">,</span> <span class="n">url</span><span class="o">=</span><span class="n">url</span><span class="p">,</span> <span class="n">parameters</span><span class="o">=</span><span class="n">params</span><span class="p">)</span>
    <span class="n">signature_method</span> <span class="o">=</span> <span class="n">oauth2</span><span class="o">.</span><span class="n">SignatureMethod_HMAC_SHA1</span><span class="p">()</span>
    <span class="n">request</span><span class="o">.</span><span class="n">sign_request</span><span class="p">(</span><span class="n">signature_method</span><span class="p">,</span> <span class="n">consumer</span><span class="p">,</span> <span class="bp">None</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">request</span><span class="o">.</span><span class="n">to_header</span><span class="p">()</span>

<span class="n">now</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
<span class="n">params</span> <span class="o">=</span> <span class="p">{</span><span class="s">'start_time'</span><span class="p">:</span> <span class="n">now</span> <span class="o">-</span> <span class="mi">24</span><span class="o">*</span><span class="mi">60</span><span class="o">*</span><span class="mi">60</span><span class="p">,</span> <span class="s">'end_time'</span><span class="p">:</span> <span class="n">now</span><span class="p">}</span> <span class="c"># get the last 24 hours</span>
<span class="n">query</span> <span class="o">=</span> <span class="s">"</span><span class="si">%</span><span class="s">s?</span><span class="si">%</span><span class="s">s"</span> <span class="o">%</span> <span class="p">(</span><span class="n">URL</span><span class="p">,</span> <span class="n">urllib</span><span class="o">.</span><span class="n">urlencode</span><span class="p">(</span><span class="n">params</span><span class="p">))</span>
<span class="c">#print(query)</span>
<span class="k">try</span><span class="p">:</span>
    <span class="n">request</span> <span class="o">=</span> <span class="n">urllib2</span><span class="o">.</span><span class="n">Request</span><span class="p">(</span><span class="n">query</span><span class="p">)</span>
    <span class="n">request</span><span class="o">.</span><span class="n">headers</span> <span class="o">=</span> <span class="n">build_auth_header</span><span class="p">(</span><span class="n">URL</span><span class="p">,</span> <span class="s">'GET'</span><span class="p">)</span>
    <span class="n">connection</span> <span class="o">=</span> <span class="n">urllib2</span><span class="o">.</span><span class="n">urlopen</span><span class="p">(</span><span class="n">request</span><span class="p">)</span>
    <span class="n">data</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="s">''</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">connection</span><span class="o">.</span><span class="n">readlines</span><span class="p">()))</span>
    <span class="k">print</span><span class="p">(</span><span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">indent</span><span class="o">=</span><span class="mi">4</span><span class="p">))</span>
<span class="k">except</span> <span class="n">urllib2</span><span class="o">.</span><span class="n">HTTPError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
    <span class="k">print</span><span class="p">(</span><span class="n">e</span><span class="o">.</span><span class="n">read</span><span class="p">())</span>
</code></pre></div>
<p>Now we need to get our new <code>data</code> variable into CartoDB&rsquo;s postgreSQL
server. <a href="http://developers.cartodb.com/documentation/sql-api.html">CartoDB&rsquo;s SQL API documentation</a> makes this possible, and
there&rsquo;s even a <a href="https://github.com/vizzuality/cartodb-python">python module</a> that wraps OAuth2 to simplify
things. Although its still in the early stages of development, this
module works fine for our current purposes; all we have to do is send
it a string that holds the SQL query we want to run. So now we&rsquo;ll just
write a for-loop that successively builds an <code>INSERT</code> query for each
element in <code>data</code> (lines 18-20 highlighted below).</p>
<div class="highlight"><pre><code class="language-python" data-lang="python"><span class="kn">from</span> <span class="nn">cartodb</span> <span class="kn">import</span> <span class="n">CartoDBException</span><span class="p">,</span> <span class="n">CartoDBAPIKey</span>

<span class="n">user</span> <span class="o">=</span>  <span class="s">'spencer.g.boucher@gmail.com'</span>
<span class="n">password</span> <span class="o">=</span>  <span class="s">'redacted'</span>
<span class="n">cartodb_domain</span> <span class="o">=</span> <span class="s">'justmytwospence'</span>
<span class="n">API_KEY</span> <span class="o">=</span><span class="s">'redacted'</span>
<span class="n">cl</span> <span class="o">=</span> <span class="n">CartoDBAPIKey</span><span class="p">(</span><span class="n">API_KEY</span><span class="p">,</span> <span class="n">cartodb_domain</span><span class="p">)</span>

<span class="k">for</span> <span class="n">reading</span> <span class="ow">in</span> <span class="n">data</span><span class="p">:</span>
    <span class="n">alt</span>     <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">reading</span><span class="p">[</span><span class="s">'alt'</span><span class="p">])</span>
    <span class="n">device</span>  <span class="o">=</span>     <span class="n">reading</span><span class="p">[</span><span class="s">'device'</span><span class="p">]</span>
    <span class="n">lat</span>     <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">reading</span><span class="p">[</span><span class="s">'lat'</span><span class="p">])</span>
    <span class="n">lon</span>     <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">reading</span><span class="p">[</span><span class="s">'lon'</span><span class="p">])</span>
    <span class="n">os</span>      <span class="o">=</span>     <span class="n">reading</span><span class="p">[</span><span class="s">'os'</span><span class="p">]</span>
    <span class="n">t</span>       <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">reading</span><span class="p">[</span><span class="s">'t'</span><span class="p">])</span>
    <span class="n">version</span> <span class="o">=</span>     <span class="n">reading</span><span class="p">[</span><span class="s">'version'</span><span class="p">]</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">query_string</span> <span class="o">=</span> <span class="s">"INSERT INTO openpaths_justmytwospence (alt, date, device, lat,  lon, os, version, the_geom) "</span>
                       <span class="s">"VALUES ({0}, abstime({1}), '{2}', {3}, {4}, '{5}', '{6}', ST_ SetSRID(ST_Point({4}, {3}), 4326))"</span>
                      <span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">alt</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="n">device</span><span class="p">,</span> <span class="n">lat</span><span class="p">,</span> <span class="n">lon</span><span class="p">,</span> <span class="n">os</span><span class="p">,</span> <span class="n">version</span><span class="p">)</span>
        <span class="k">print</span> <span class="n">cl</span><span class="o">.</span><span class="n">sql</span><span class="p">(</span><span class="n">query_string</span><span class="p">)</span>
    <span class="k">except</span> <span class="n">CartoDBException</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="k">print</span> <span class="p">(</span><span class="s">"some error ocurred"</span><span class="p">,</span> <span class="n">e</span><span class="p">)</span>
</code></pre></div>
<p>A few notes:</p>

<ul>
<li>  It would certainly be faster to insert all of the new data into the
database using a single <code>INSERT</code> statement, but that would require
some more tedious text parsing and execution speed isn&rsquo;t
particularly important to us. As it stands, it takes about six
seconds to post a day&rsquo;s worth of data.</li>
<li>  One posgreSQL &ldquo;gotcha&rdquo; had me hung up for quite some time: single
quotes parse fine but double quotes do not.</li>
<li>  <code>ST_SetSRID</code> is a <a href="http://postgis.org/docs/ST_SetSRID.html">PostGIS command</a> that converts a lon/lat pair
(in that order - another &ldquo;gotcha&rdquo;) to the necessary geometry object.</li>
</ul>

<p>Last but not least, we need this script to run automatically. Because
we&rsquo;ve written the script to transplant 24 hours of data, we&rsquo;ll need to
run it once a day in order to capture all of the data that&rsquo;s being
generated. I tried to set up my web host, <a href="https://laughingsquid.us/">LaughingSquid</a>, to do
this, but unfortunately they don&rsquo;t grant shell access so we can&rsquo;t
install all those fancy python modules that we&rsquo;ve already used. Its
totally possible to rewrite the script to use only modules from the
<a href="http://docs.python.org/2/library/">Python Standard Library</a>, but this would turn a simple task into a
tedious one. Manually implementing OAuth in particular would be a
total pain in the rear, and classes are just about to resume after
all, so a different solution is in order. Let&rsquo;s spin up a
<a href="http://aws.amazon.com/">&ldquo;micro&rdquo; EC2 instance</a> instead. This gives us free reign to install
whatever we need for the low low cost of ¢.02 per hour. This does
start to add up, but our Master&rsquo;s program gives us some pretty
substantial Amazon Web Services credit that goes mostly unused, so we
aren&rsquo;t too upset :). UPDATE: A new post provides details about how to
schedule Amazon EC2 instances -
<a href="http://www.spencerboucher.com/ec2-apis/">http://www.spencerboucher.com/ec2-apis/</a>.</p>

<p>After <code>pip install</code>ing everything we need and <code>scp</code>ing our python
script (let&rsquo;s call it update.py) into the home directory of our remote
server, all we need to do is set up a crontab with the <code>crontab -e</code>
command and add the following line:</p>
<div class="highlight"><pre><code class="language-bash" data-lang="bash">@daily /usr/bin/python ~/update.py
</code></pre></div>
<p><code>@daily</code> is actually a shortcut for <code>* * * * *</code>, where each asterix is
a placeholder for the (respectively) minute, hour, day of month,
month, and day of week that the script should executed. This shortcut
defaults to midnight every day, which is really as good as anything
for our purposes.</p>

<p>Voilà! Now we can step back and relax, knowing that we don&rsquo;t have to
do a single thing and our map will continue to show the most
up-to-date data available.</p>

<p>A few final notes:</p>

<ul>
<li>We might reasonably want to lag our script by a week or so, for
security/privacy reasons.</li>
<li>As far as I can tell, the location readings are recorded in a
<a href="http://en.wikipedia.org/wiki/Unix_time">POSIX time</a> and have not been adjusted by time zone, so they are
still in the <a href="http://en.wikipedia.org/wiki/Coordinated_Universal_Time">UTC</a> time zone. This means that they are 8 hours
off from the actual time in California, where I usually am. This
doesn&rsquo;t bother me too much at the moment because the visualization
is still relatively low resolution in the time domain anyways. At
some point I might implement the relevant transformation, but this
will raise its own issues because I won&rsquo;t <em>always</em> be in
California, not to mention all that Daylight Savings nonsense.</li>
<li><a href="http://www.spencerboucher.com/ec2-apis/">Click here for an addendum to this post that will take you through how to schedule the EC2 instance and avoid having it run 24/7</a></li>
</ul>

</article>




  <div class="py2 post-footer">
  <img src="/images/avatar.jpg" alt="Spencer Boucher" class="avatar" />
  <p>
    Spencer is a data scientist living in San Francisco, California.
  </p>
  <p>
    The source code for this post can be found here.
  </p>
</div>




  <div id="disqus_thread"></div>
  <script type="text/javascript">
    var disqus_shortname  = 'justmytwospence';
    var disqus_identifier = '/live-mapping';
    var disqus_title      = 'Live mapping';

    (function() {
      var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
      dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
  </script>
  <noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>






      </div>
    </div>
  </div>

  <footer class="center">
  <div class="measure">
    <small>
      Built with jekyll, github-pages, and <a href="https://github.com/johnotander/pixyll">Pixyll</a>.
    </small>
  </div>
</footer>

</body>
</html>
